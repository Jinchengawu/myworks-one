{"remainingRequest":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhanyuan/code/oc-works/fuli/src/views/customerManagement/tab-contacts.vue?vue&type=style&index=0&id=cc334f22&lang=less&scoped=true&","dependencies":[{"path":"/Users/wangzhanyuan/code/oc-works/fuli/src/views/customerManagement/tab-contacts.vue","mtime":1564134165925},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/less-loader/dist/cjs.js","mtime":1564134317354},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.Tit-box{\n    width: 70%;    \n    .Tit-box-title{\n      line-height: 30px;\n      font-size: 14px;\n      text-align: center;\n    }\n    .Tit-box-cont{\n      line-height: 80px;\n      margin-top: -10px;\n      font-size: 15px;\n      text-align: center;\n    }\n    .Tit-box-buts{\n      display: flex;\n      justify-content: space-between;\n    }\n    .Tit-box-but{\n      flex: 1;\n    }\n  }\n.contact_container3 {\n  \n  width: 100%;\n  padding: 10px 10px 70px 10px;\n  box-sizing: border-box;\n  background: #fcfcfc;\n  .tab3_box {\n    width: 100%;\n    .tab3-list {\n      width: 100%;\n      background: #ffffff;\n      box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n      border-radius: 5px;\n      padding: 10px 20px;\n      box-sizing: border-box;\n      margin-bottom: 15px;\n      position: relative;\n      .list-tel {\n        position: absolute;\n        bottom: 65px;\n        right: 20px;\n      }\n      .list-wx{\n        position: absolute;\n        bottom: 60px;\n        right: 45px;\n      }\n      .tab3-list-tilte {\n        width: 100%;\n        height: 35px;\n        line-height: 35px;\n        margin-bottom: 15px;\n        .span1 {\n          font-size: 16px;\n          color: #333333;\n          font-weight: bold;\n          float: left;\n        }\n        .span2 {\n          font-size: 12px;\n          color: #999999;\n          float: right;\n        }\n      }\n      .tab3-list-p {\n        width: 100%;\n        height: 25px;\n        line-height: 25px;\n        display: flex;\n        .text-label {\n          font-size: 14px;\n          color: #999999;\n          width: 100px;\n          height: 25px;\n        }\n        .text-info {\n          font-size: 14px;\n          color: #333333;\n          width: 100%;\n          height: 25px;\n        }\n      }\n    }\n  }\n  .tab3-footer {\n    width: 100%;\n    height: 70px;\n    background: #fcfcfc;\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    padding: 0 10px;\n    box-sizing: border-box;\n  }\n}\n.tab-footer {\n  width: 100%;\n  height: 70px;\n  background: #fcfcfc;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  padding: 0 10px;\n  box-sizing: border-box;\n}\n",{"version":3,"sources":["tab-contacts.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoSA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"tab-contacts.vue","sourceRoot":"src/views/customerManagement","sourcesContent":["<template>\n  <div name=\"contacts\">\n    <div class=\"contact_container3\">\n      <div class=\"tab3_box\">\n        <van-list\n          v-model=\"loading\"\n          :finished=\"finished\"\n          :finished-text=\"finished_text\"\n          :error.sync=\"error\"\n          error-text=\"请求失败，点击重新加载\"\n          @load=\"onLoad()\"\n        >\n          <div\n            v-for=\"(itm,idx) in userList\"\n            :key=\"idx\"\n            class=\"tab3-list\"\n          >\n            <div class=\"tab3-list-tilte\">\n              <span class=\"span1\">{{ itm.contactsName }}</span>\n              <span\n                class=\"span2\"\n              >{{ itm.contactsIdentification }}</span>\n              <span\n                v-if=\"!itm.contactsIdentification\"\n                class=\"span2 theme-colors\"\n                @click=\"setTopUser(itm.contactsId)\"\n              >置顶</span>\n            </div>\n            <div class=\"tab3-list-p\">\n              <div class=\"text-label\">\n                对应客户\n              </div>\n              <div class=\"text-info\">\n                {{ itm.companyName }}\n              </div>\n            </div>\n            <div class=\"tab3-list-p\">\n              <div class=\"text-label\">\n                职务\n              </div>\n              <div class=\"text-info\">\n                {{ itm.contactsPost }}\n              </div>\n            </div>\n            <div class=\"tab3-list-p\">\n              <div class=\"text-label\">\n                手机\n              </div>\n              <div class=\"text-info\">\n                {{ itm.contactsMoblie }}\n              </div>\n            </div>\n            <div class=\"tab3-list-p\">\n              <div class=\"text-label\">\n                性别\n              </div>\n              <div class=\"text-info\">\n                {{ itm.contactsSex }}\n              </div>\n            </div>\n            <div class=\"tab3-list-p\">              \n              <div class=\"text-info\">\n                <span style=\"float:right;\">\n                  <span\n                    v-if=\"PermissionObj['concatinfo_list'] != undefined\"\n                    class=\"theme-colors\"\n                    @click=\"openUser(itm.contactsId,1)\"\n                  >查看</span>\n                  <span\n                    class=\"theme-colors\"\n                    style=\"position:relative;top:-1px;margin:0 5px;\"\n                  >|</span>\n                  <span\n                    v-if=\"PermissionObj['concatinfo_update'] != undefined\"\n                    class=\"theme-colors\"\n                    @click.stop=\"openUser(itm.contactsId,2)\"\n                  >编辑</span>\n                  <span\n                    v-if=\"!itm.contactsIdentification\"\n                    class=\"theme-colors\"\n                    style=\"position:relative;top:-1px;margin:0 5px;\"\n                  >|</span>\n                  <span                  \n                    v-if=\"PermissionObj['concatinfo_update'] != undefined&&!itm.contactsIdentification\"\n                    class=\"theme-colors\"                    \n                    @click=\"boxShow(itm)\"                    \n                  >删除</span>\n                </span>\n              </div>\n            </div>\n            <a :href=\"'tel:'+itm.contactsMoblie\">\n              <span class=\"iconfont iconicon_tel theme-colors list-tel\" />\n            </a>\n            <span\n              v-if=\"itm.externalContactIds\"\n              class=\"theme-colors list-wx\"\n              @click=\"createdMeet(itm.externalContactIds)\"\n            > <img\n              style=\"width:20px;height:20px;\"\n              src=\"../../assets/img/wxLOGO.jpg\"\n              alt=\"\"\n            > </span>\n          </div>\n        </van-list>\n      </div>\n\n      <div\n        v-if=\"PermissionObj['concatinfo_insert'] != undefined\"\n        class=\"tab-footer\"\n      >\n        <van-button\n          class=\"gradual-btn\"\n          style=\"width:100%;\"\n          type=\"primary\"\n          to=\"/addContact\"\n        >\n          新建联络人\n        </van-button>\n      </div>\n    </div>\n    <van-popup\n      v-model=\"show\"\n      class=\"Tit-box\"\n    >\n      <div class=\"Tit-box-title\">\n        提示\n      </div>\n      <div class=\"Tit-box-cont\">\n        确认删除？\n      </div>\n      <div class=\"Tit-box-buts\">\n        <van-button\n          class=\"Tit-box-but\"\n          type=\"primary\"\n          square\n          @click=\"deleteThis\"\n        >\n          确认\n        </van-button>\n        <van-button\n          class=\"Tit-box-but\"\n          square\n          @click=\"boxShow\"\n        >\n          取消\n        </van-button>\n      </div>\n    </van-popup>\n  </div>\n</template>\n<script>\nimport { deleteCallUser, callUserList, setTopCallUser,topUser } from '@/service/customer'\nexport default {\n  name: 'Contacts',\n  data() {\n    return {\n      PermissionObj:this.$store.state.powerList.PermissionObj,///权限\n      userList: [],\n      loading: false,\n      finished: false,\n      finished_text: '没有数据了哦',\n      error: false,\n      total: null,\n      page: 1,\n      size: 10,\n      show:false\n    }\n  },\n  computed: {},\n  created() {\n    // this.getData();\n  },\n  methods: {   \n    createdMeet(UID){\n      wx.openEnterpriseChat({\n\t\t\t\t\t// 注意：userIds和externalUserIds至少选填一个，且userIds+openIds总数不能超过2000。\n\t\t\t\t\texternalUserIds : UID, //参与会话的企业成员列表，格式为userid1;userid2;...，用分号隔开。\n\t\t\t\t\tgroupName : '', // 必填，会话名称。单聊时该参数传入空字符串\"\"即可。\n\t\t\t\t\tsuccess : function(res) {\n            console.log('创建会话',res)\n\t\t\t\t\t\t// 回调\n\t\t\t\t\t},\n\t\t\t\t\tfail : function(res) {\n\t\t\t\t\t\tif (res.errMsg.indexOf('function not exist') > -1) {\n\t\t\t\t\t\t\talert('版本过低请升级')\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t})\n      console.log('openEnterpriseChat回话接口',wx.openEnterpriseChat) \n    }, \n    boxShow(itm){\n      this.show = !this.show\n      if(!this.show)this.delItm = null\n      else this.delItm = itm\n      console.log('this.delItm',this.delItm)\n    },\n    onLoad() {\n      if (this.userList.length === this.total) {\n        this.finished_text = '没有更多数据啦'\n        this.finished = true // 数据全部加载完成\n        this.loading = false// 加载状态结束\n        return\n      }\n      // 下拉加载事件\n      setTimeout((res) => {\n        // console.log(res)\n        this.getData()\n      }, 1000)\n    },\n    // 删除联络人\n    deleteThis() {\n      // console.log('Uid', Uid)\n      deleteCallUser({ contactsId: this.delItm.contactsId }).then((res) => {\n        // console.log('deleteCallUser', res)\n        if (res.data) {\n          // eslint-disable-next-line array-callback-return\n          this.userList.map((d, idx) => {\n            if (d.contactsId === this.delItm.contactsId) {\n              this.userList.splice(idx, 1)\n            }\n          })\n          this.$notify({\n            message: '删除成功',\n            duration: 1000,\n            background: 'green',\n          })\n          this.boxShow()\n        } else {\n          this.$notify('删除失败')\n        }\n      })\n    },\n    update() { },\n    getData() {\n      callUserList(\n        { companyId: this.$store.getters.userData.companyId, page: this.page, size: this.size },\n      ).then((res) => {\n        let DArr = res.data.data\n        DArr = DArr || []\n        let one = {}\n        let two = {}\n        let UserArr = []\n        DArr.map((d, idx) => {          \n          if (d.contactsIdentification === '第一联络人') {\n            one=d\n          }\n          if (d.contactsIdentification === '第二联络人') {\n            two=d\n          }\n          if (d.contactsIdentification != '第二联络人'&&d.contactsIdentification != '第一联络人') {\n            UserArr.push(d)\n          }\n          return d\n        })   \n        if(two.companyName){\n          UserArr.unshift(two)\n        } \n        if(one.companyName){\n          UserArr.unshift(one)\n        }\n        // console.log(UserArr1,UserArr2,UserArr3)\n        this.userList = this.userList.concat(UserArr)\n        this.total = res.data.total\n        // eslint-disable-next-line no-plusplus\n        this.page++\n        this.loading = false// 加载状态结束\n      })\n    },\n    openUser(id,openType) {\n      // console.log()\n      this.$router.push({\n        path: '/addContact',\n        query: {\n          id,\n          openType\n        },\n      })\n    },\n    setTopUser(id) {      \n      topUser({ contactsId: id }).then((res) => {\n        console.log('res',res)\n        this.total=null\n        this.page=1\n        this.userList = []\n        this.loading=false\n        this.finished=false\n      })\n    },\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.Tit-box{\n    width: 70%;    \n    .Tit-box-title{\n      line-height: 30px;\n      font-size: 14px;\n      text-align: center;\n    }\n    .Tit-box-cont{\n      line-height: 80px;\n      margin-top: -10px;\n      font-size: 15px;\n      text-align: center;\n    }\n    .Tit-box-buts{\n      display: flex;\n      justify-content: space-between;\n    }\n    .Tit-box-but{\n      flex: 1;\n    }\n  }\n.contact_container3 {\n  \n  width: 100%;\n  padding: 10px 10px 70px 10px;\n  box-sizing: border-box;\n  background: #fcfcfc;\n  .tab3_box {\n    width: 100%;\n    .tab3-list {\n      width: 100%;\n      background: #ffffff;\n      box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n      border-radius: 5px;\n      padding: 10px 20px;\n      box-sizing: border-box;\n      margin-bottom: 15px;\n      position: relative;\n      .list-tel {\n        position: absolute;\n        bottom: 65px;\n        right: 20px;\n      }\n      .list-wx{\n        position: absolute;\n        bottom: 60px;\n        right: 45px;\n      }\n      .tab3-list-tilte {\n        width: 100%;\n        height: 35px;\n        line-height: 35px;\n        margin-bottom: 15px;\n        .span1 {\n          font-size: 16px;\n          color: #333333;\n          font-weight: bold;\n          float: left;\n        }\n        .span2 {\n          font-size: 12px;\n          color: #999999;\n          float: right;\n        }\n      }\n      .tab3-list-p {\n        width: 100%;\n        height: 25px;\n        line-height: 25px;\n        display: flex;\n        .text-label {\n          font-size: 14px;\n          color: #999999;\n          width: 100px;\n          height: 25px;\n        }\n        .text-info {\n          font-size: 14px;\n          color: #333333;\n          width: 100%;\n          height: 25px;\n        }\n      }\n    }\n  }\n  .tab3-footer {\n    width: 100%;\n    height: 70px;\n    background: #fcfcfc;\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    padding: 0 10px;\n    box-sizing: border-box;\n  }\n}\n.tab-footer {\n  width: 100%;\n  height: 70px;\n  background: #fcfcfc;\n  position: fixed;\n  bottom: 0;\n  left: 0;\n  padding: 0 10px;\n  box-sizing: border-box;\n}\n</style>\n"]}]}