{"remainingRequest":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhanyuan/code/oc-works/fuli/src/views/addRepayment/addRepayment.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhanyuan/code/oc-works/fuli/src/views/addRepayment/addRepayment.vue","mtime":1564134165923},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// import { api, get, post } from \"@/service\";\nimport { mapState } from 'vuex'\nimport { formatDate, isNull } from '@/utils'\nimport { fuLiRentBack,getfuLiRentBack } from '@/service/loan.js'\nimport { projectList } from '@/service/customer.js'\nexport default {\n  name: 'AddRepayment',\n  data() {\n    return {\n      project: -1, // 所属项目\n      tenancy: -1, // 所属项目\n      selectStartTime: false,\n      selectEndTime: false,\n      maxDate: new Date(),\n      minDate: new Date(1900, 1, 1),\n      currentTime: new Date(),\n      form:{\n        createUserId:'',\n        projectId:'',\n        startRentTime:'',\n        rentTime:'',\n        startRentTime:'',\n        rentPayTime:'',\n        principalPart:'',\n        interestPart:'',\n        termRent:'',\n        lendingId:'',\n        rentBackName:'',\n        companyName:''\n      },\n      \n      pgList:[],\n      isShow :true,\n      OTP:false\n    }\n  },\n  computed: {\n  \n  },\n  watch: {},\n  mounted() {\n    \n  },\n\n  created() { \n    if(this.$route.query.Tid){      \n      this.getTdata(this.$route.query.Tid)\n      this.isShow = false\n      this.OTP = true\n    }else{\n      this.getProjectList()\n      this.form.companyName=this.$store.getters.userData.companyName\n      this.form.lendingId=this.$route.query.id\n      this.form.rentBackName='第'+this.$route.query.ln+'次还款'\n      this.form.createUserId=this.$store.getters.userInfo.id\n    }\n    \n  },\n  methods: {\n    getTdata(id){\n      getfuLiRentBack({id:id}).then(res=>{\n        // console.log('getfuLiRentBack',res)\n        this.form =res.data      \n        this.form.projectName = this.form.information.projectName\n\n        this.pgList.push(this.form)\n        // console.log('this.form',this.form,this.pgList)  \n      })  \n    },\n    addbut(){\n      this.addRPM()\n    },\n    addRPM(){\n      let params = {...this.form}\n      this.pgList.map(d=>{\n        params.projectId = d.information.projectName == params.projectName ? d.id: params.projectId\n      })\n      params.projectId = this.$route.query.pid\n      fuLiRentBack(params).then(res=>{\n        this.$router.go(-1)\n      })\n    },\n    \n    getProjectList() {\n      const params = {\n        menuType: 1,\n        size:1000\n      }\n      projectList(params).then((res) => {\n        console.log('projectList', res)\n        if(res.total==0)return\n        this.pgList = res.data\n        if(res.data.length>0){\n          if(this.form.projectName){\n            return\n          }\n          this.form.projectName = res.data[0].information.projectName\n        }\n      })\n    },\n    formatter(type, value) {\n      if (type === 'year') {\n        return `${value}年`\n      } if (type === 'month') {\n        return `${value}月`\n      }\n      return `${value}日`\n    },\n    startTimeClick() {\n      if(this.$route.query.Tid)return\n      this.selectStartTime = true\n    },\n    endTimeClick() {\n      if(this.$route.query.Tid)return\n      this.selectEndTime = true\n    },\n    startconfirm(e) {\n      // 选开始时间\n      if (isNull(e)) {\n        this.selectStartTime = false\n      } else {\n        const time = formatDate(new Date(e), 'yyyy-MM-dd', 'special')\n        const timeStr = time.split('-')\n        this.form.startRentTime = `${timeStr[0]}-${timeStr[1]}-${timeStr[2]}`\n        this.selectStartTime = false\n      }\n    },\n    endconfirm(e) {\n      // 选开始时间\n      if (isNull(e)) {\n        this.selectEndTime = false\n      } else {\n        const time = formatDate(new Date(e), 'yyyy-MM-dd', 'special')\n        const timeStr = time.split('-')\n        this.form.rentPayTime = `${timeStr[0]}-${timeStr[1]}-${timeStr[2]}`\n        this.selectEndTime = false\n      }\n    },\n    onRead() { },\n  },\n}\n",{"version":3,"sources":["addRepayment.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"addRepayment.vue","sourceRoot":"src/views/addRepayment","sourcesContent":["<template>\n  <div class=\"addRepayment\">\n    <div class=\"container\">\n      <van-cell-group :border=\"false\">\n        <van-field\n          v-model=\"form.companyName\"\n          label=\"客户\"\n          type=\"text\"\n          input-align=\"right\"\n          placeholder=\"请输入\"\n          :error=\"false\"\n          :border=\"false\"\n          :readonly=\"true\"\n        />\n\n        <div class=\"select-list\">\n          <div class=\"list\">\n            <div class=\"left\">\n              所属项目\n            </div>\n            <div class=\"right\">\n              <select\n                v-model=\"form.projectName\"\n                v-placeholder=\"{color: form.projectName}\"\n                :disabled=\"OTP\"\n              >\n                <option\n                  v-for=\"(item,idx) in pgList\"\n                  :key=\"idx\"\n                  :value=\"item.information.projectName\"\n                >\n                  {{ item.information.projectName }}\n                </option>\n              </select>\n            </div>\n            <div\n              v-sanjiao=\"{color: form.projectName}\"\n              class=\"saojiao\"\n            />\n          </div>\n        </div>\n        \n        <div class=\"money-text\">\n          <van-field\n            v-model=\"form.rentTime\"\n            style=\"width:90%;\"\n            label=\"租期\"\n            type=\"number\"\n            input-align=\"right\"\n            placeholder=\"请输入租期 单位:\"\n            :error=\"false\"\n            :border=\"false\"\n            :readonly=\"!isShow\"\n          />\n          <span class=\"right-text\">月</span>\n        </div>\n\n        <div class=\"select-list\">\n          <div\n            class=\"list\"\n            @click=\"startTimeClick()\"\n          >\n            <div class=\"left\">\n              起租日\n            </div>\n            <div\n              class=\"right\"\n              :class=\"{'selectPlaceholder':form.startRentTime== ''}\"\n            >\n              {{ form.startRentTime== '' ? '请选择' : form.startRentTime }}\n            </div>\n            <div class=\"timeBox\">\n              <span\n                class=\"iconfont iconrili\"\n                style=\"color:#aebab4\"\n              />\n            </div>\n          </div>\n        </div>\n\n        <div class=\"select-list\">\n          <div\n            class=\"list\"\n            @click=\"endTimeClick()\"\n          >\n            <div class=\"left\">\n              租金支付日期\n            </div>\n            <div\n              class=\"right\"\n              :class=\"{'selectPlaceholder':form.rentPayTime== ''}\"\n            >\n              {{ form.rentPayTime== '' ? '请选择' : form.rentPayTime }}\n            </div>\n            <div class=\"timeBox\">\n              <span\n                class=\"iconfont iconrili\"\n                style=\"color:#aebab4\"\n              />\n            </div>\n          </div>\n        </div>\n        <div class=\"money-text\">\n          <van-field\n            v-model=\"form.principalPart\"\n            style=\"width:90%;\"\n            label=\"本金部分\"\n            type=\"number\"\n            input-align=\"right\"\n            placeholder=\"请输入本金部分 单位:\"\n            :error=\"false\"\n            :border=\"false\"\n            :readonly=\"!isShow\"\n          />\n          <span class=\"right-text\">万元</span>\n        </div>\n        <div class=\"money-text\">\n          <van-field\n            v-model=\"form.interestPart\"\n            style=\"width:90%;\"\n            label=\"利息部分\"\n            type=\"number\"\n            input-align=\"right\"\n            placeholder=\"请输入利息部分 单位:\"\n            :error=\"false\"\n            :border=\"false\"\n            :readonly=\"!isShow\"\n          />\n          <span class=\"right-text\">万元</span>\n        </div>\n        <div class=\"money-text\">\n          <van-field\n            v-model=\"form.termRent\"\n            style=\"width:90%;\"\n            label=\"每期租金\"\n            type=\"number\"\n            input-align=\"right\"\n            placeholder=\"请输入每期租金 单位:\"\n            :error=\"false\"\n            :border=\"false\"\n            :readonly=\"!isShow\"\n          />\n          <span class=\"right-text\">万元</span>\n        </div>\n      </van-cell-group>\n\n      <div class=\"footer\">\n        <van-button\n          v-if=\"isShow\"\n          class=\"gradual-btn\"\n          style=\"width:100%;\"\n          type=\"primary\"\n          @click=\"addbut\"\n        >\n          确认信息\n        </van-button>\n      </div>\n    </div>\n\n    <!--  时间选择 -->\n    <van-popup\n      v-model=\"selectStartTime\"\n      position=\"bottom\"\n      :overlay=\"true\"\n    >\n      <van-datetime-picker\n        v-model=\"currentTime\"\n        type=\"date\"\n        :min-date=\"minDate\"\n        :formatter=\"formatter\"\n        @confirm=\"startconfirm($event)\"\n        @cancel=\"startconfirm()\"\n      />\n    </van-popup>\n\n    <!--  时间选择 -->\n    <van-popup\n      v-model=\"selectEndTime\"\n      position=\"bottom\"\n      :overlay=\"true\"\n    >\n      <van-datetime-picker\n        v-model=\"currentTime\"\n        type=\"date\"        \n        :min-date=\"minDate\"\n        :formatter=\"formatter\"\n        @confirm=\"endconfirm($event)\"\n        @cancel=\"endconfirm()\"\n      />\n    </van-popup>\n  </div>\n</template>\n<script>\n// import { api, get, post } from \"@/service\";\nimport { mapState } from 'vuex'\nimport { formatDate, isNull } from '@/utils'\nimport { fuLiRentBack,getfuLiRentBack } from '@/service/loan.js'\nimport { projectList } from '@/service/customer.js'\nexport default {\n  name: 'AddRepayment',\n  data() {\n    return {\n      project: -1, // 所属项目\n      tenancy: -1, // 所属项目\n      selectStartTime: false,\n      selectEndTime: false,\n      maxDate: new Date(),\n      minDate: new Date(1900, 1, 1),\n      currentTime: new Date(),\n      form:{\n        createUserId:'',\n        projectId:'',\n        startRentTime:'',\n        rentTime:'',\n        startRentTime:'',\n        rentPayTime:'',\n        principalPart:'',\n        interestPart:'',\n        termRent:'',\n        lendingId:'',\n        rentBackName:'',\n        companyName:''\n      },\n      \n      pgList:[],\n      isShow :true,\n      OTP:false\n    }\n  },\n  computed: {\n  \n  },\n  watch: {},\n  mounted() {\n    \n  },\n\n  created() { \n    if(this.$route.query.Tid){      \n      this.getTdata(this.$route.query.Tid)\n      this.isShow = false\n      this.OTP = true\n    }else{\n      this.getProjectList()\n      this.form.companyName=this.$store.getters.userData.companyName\n      this.form.lendingId=this.$route.query.id\n      this.form.rentBackName='第'+this.$route.query.ln+'次还款'\n      this.form.createUserId=this.$store.getters.userInfo.id\n    }\n    \n  },\n  methods: {\n    getTdata(id){\n      getfuLiRentBack({id:id}).then(res=>{\n        // console.log('getfuLiRentBack',res)\n        this.form =res.data      \n        this.form.projectName = this.form.information.projectName\n\n        this.pgList.push(this.form)\n        // console.log('this.form',this.form,this.pgList)  \n      })  \n    },\n    addbut(){\n      this.addRPM()\n    },\n    addRPM(){\n      let params = {...this.form}\n      this.pgList.map(d=>{\n        params.projectId = d.information.projectName == params.projectName ? d.id: params.projectId\n      })\n      params.projectId = this.$route.query.pid\n      fuLiRentBack(params).then(res=>{\n        this.$router.go(-1)\n      })\n    },\n    \n    getProjectList() {\n      const params = {\n        menuType: 1,\n        size:1000\n      }\n      projectList(params).then((res) => {\n        console.log('projectList', res)\n        if(res.total==0)return\n        this.pgList = res.data\n        if(res.data.length>0){\n          if(this.form.projectName){\n            return\n          }\n          this.form.projectName = res.data[0].information.projectName\n        }\n      })\n    },\n    formatter(type, value) {\n      if (type === 'year') {\n        return `${value}年`\n      } if (type === 'month') {\n        return `${value}月`\n      }\n      return `${value}日`\n    },\n    startTimeClick() {\n      if(this.$route.query.Tid)return\n      this.selectStartTime = true\n    },\n    endTimeClick() {\n      if(this.$route.query.Tid)return\n      this.selectEndTime = true\n    },\n    startconfirm(e) {\n      // 选开始时间\n      if (isNull(e)) {\n        this.selectStartTime = false\n      } else {\n        const time = formatDate(new Date(e), 'yyyy-MM-dd', 'special')\n        const timeStr = time.split('-')\n        this.form.startRentTime = `${timeStr[0]}-${timeStr[1]}-${timeStr[2]}`\n        this.selectStartTime = false\n      }\n    },\n    endconfirm(e) {\n      // 选开始时间\n      if (isNull(e)) {\n        this.selectEndTime = false\n      } else {\n        const time = formatDate(new Date(e), 'yyyy-MM-dd', 'special')\n        const timeStr = time.split('-')\n        this.form.rentPayTime = `${timeStr[0]}-${timeStr[1]}-${timeStr[2]}`\n        this.selectEndTime = false\n      }\n    },\n    onRead() { },\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.container {\n  width: 100%;\n  padding-bottom: 100px;\n  .select-map {\n    width: 100%;\n    padding: 0px 15px 0px 15px;\n    box-sizing: border-box;\n    .title-header {\n      width: 80%;\n      height: 40px;\n      line-height: 40px;\n      background-color: #fff;\n      color: #323233;\n      font-size: 14px;\n      color: #323233;\n      font-size: 14px;\n      padding-right: 15px;\n      white-space: nowrap;\n      overflow: hidden;\n      text-overflow: ellipsis;\n    }\n    .body {\n      width: 100%;\n      height: 240px;\n      background: #f4f4f4;\n    }\n    .uploadFile {\n      width: 100px;\n      height: 100px;\n      border: 1px dashed #979797;\n      position: relative;\n      .uploadIcon {\n        font-size: 30px;\n        position: absolute;\n        top: 15px;\n        left: 35px;\n        color: #979797;\n      }\n      .uploadText {\n        width: 65px;\n        font-size: 16px;\n        position: absolute;\n        top: 50px;\n        left: 20px;\n        color: #979797;\n      }\n    }\n  }\n  .select-list {\n    width: 100%;\n    padding: 0px 0px 0px 15px;\n    box-sizing: border-box;\n    .addborder {\n      border-bottom: 1px solid #f5f6f8;\n    }\n    .list {\n      width: 100%;\n      height: 40px;\n      display: flex;\n      line-height: 40px;\n      background-color: #fff;\n      color: #323233;\n      font-size: 14px;\n      overflow: hidden;\n      color: #323233;\n      font-size: 14px;\n      box-sizing: border-box;\n      padding-right: 15px;\n      .left {\n        max-width: 90px;\n        height: 40px;\n      }\n      .right {\n        flex: 1;\n        height: 40px;\n        text-align: right;\n        select {\n          width: 100%;\n          height: 40px;\n          text-align: right;\n          border: none;\n          outline: none;\n          appearance: none;\n          -moz-appearance: none;\n          -webkit-appearance: none;\n          -ms-appearance: none;\n          direction: rtl;\n          text-indent: 5px;\n          background: #ffffff;\n        }\n      }\n    }\n    .saojiao {\n      width: 0;\n      height: 0;\n      border-width: 6px;\n      border-style: solid;\n      border-color: #323233 transparent transparent transparent;\n      margin-top: 17px;\n    }\n    .timeBox {\n      width: 25px;\n      height: 40px;\n      text-align: right;\n    }\n  }\n  .show-more {\n    width: 100%;\n    height: 40px;\n    line-height: 40px;\n    font-size: 12px;\n    color: #999999;\n    text-align: center;\n    .downIcon {\n      font-size: 8px;\n      position: relative;\n      left: 3px;\n      top: -1px;\n    }\n  }\n  .footer {\n    width: 100%;\n    height: 70px;\n    background: #fcfcfc;\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    padding: 0 10px;\n    box-sizing: border-box;\n  }\n}\n</style>\n"]}]}