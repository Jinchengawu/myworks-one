{"remainingRequest":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhanyuan/code/oc-works/fuli/src/App.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhanyuan/code/oc-works/fuli/src/App.vue","mtime":1564134165910},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n\nimport { wxPermission, userInfo } from '@/service/login'\nimport { mapState, mapMutations } from 'vuex'\nimport { homeList, powerList, idPowerList,} from '@/service/home'\nexport default {\n  data() {\n    return {\n      userNo: '',\n      userId:null,\n      OTarrType: [true, true],\n      OTarrName: ['企业列表', '动态列表'],\n    }\n  },\n  created() {\n    // if(!window.sessionStorage.getItem('fristLogin')){\n    //   window.sessionStorage.setItem('fristLogin',true)\n    //   this.replace('/')\n    // }\n    if(window.location.hostname == 'localhost'){\n    //测试\n      this.userNo = '21313'\n      this.getUserInfo()\n    }else{\n      //正式\n      this.init()\n    }\n  },\n  methods: {\n    ...mapMutations(['SET_USER_INFO']),\n    init() {\n      wxPermission({\n        agentId: 7,\n        url: window.location.href,\n        // state:'YiGeShenChenman'\n      }).then((res) => {\n        console.log('wxPermission登录1',res)\n        //正式代码\n        this.userNo = this.GetQueryString('userNo')        \n        if (this.userNo) {          \n          this.getUserInfo()\n        } else {\n          //正式代码\n          window.location.href = res.data\n        }\n      })\n        .catch(err => console.error(err))\n    },\n    \n    getUserInfo() {\n      userInfo({ userNo: this.userNo }).then((res) => {\n        console.log('获取用户信息getUserInfo', res)\n        this.SET_USER_INFO(res.data)\n        this.userId = res.data.id\n        this.getIdPowerList()\n      })\n    },\n    GetQueryString(name) {\n      const reg = new RegExp(`(^|&)${name}=([^&]*)(&|$)`)\n      const r = window.location.search.substr(1).match(reg)\n      if (r != null) return unescape(r[2])\n      return ''\n    },\n        // id获取权限\n    getIdPowerList() {\n      idPowerList({ id: this.userId }).then((res) => {\n        \n        this.$store.commit('SET_LIST_POWER', res)\n        // eslint-disable-next-line array-callback-return\n        this.OTarrName.map((d, idx) => {\n          this.OTarrType[idx] = res.OTarr.indexOf(d) > -1\n        })\n        console.log('getIdPowerList',this.OTarrType)\n\n        ///获取权限\n        this.$store.commit('SET_HOME_POWER', this.OTarrType)\n        // this.\n      })\n    },\n  },\n}\n",{"version":3,"sources":["App.vue"],"names":[],"mappings":";;;;;;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"App.vue","sourceRoot":"src","sourcesContent":["<template>\n  <div id=\"app\">    \n    <router-view />\n  </div>\n</template>\n<script>\nimport { wxPermission, userInfo } from '@/service/login'\nimport { mapState, mapMutations } from 'vuex'\nimport { homeList, powerList, idPowerList,} from '@/service/home'\nexport default {\n  data() {\n    return {\n      userNo: '',\n      userId:null,\n      OTarrType: [true, true],\n      OTarrName: ['企业列表', '动态列表'],\n    }\n  },\n  created() {\n    // if(!window.sessionStorage.getItem('fristLogin')){\n    //   window.sessionStorage.setItem('fristLogin',true)\n    //   this.replace('/')\n    // }\n    if(window.location.hostname == 'localhost'){\n    //测试\n      this.userNo = '21313'\n      this.getUserInfo()\n    }else{\n      //正式\n      this.init()\n    }\n  },\n  methods: {\n    ...mapMutations(['SET_USER_INFO']),\n    init() {\n      wxPermission({\n        agentId: 7,\n        url: window.location.href,\n        // state:'YiGeShenChenman'\n      }).then((res) => {\n        console.log('wxPermission登录1',res)\n        //正式代码\n        this.userNo = this.GetQueryString('userNo')        \n        if (this.userNo) {          \n          this.getUserInfo()\n        } else {\n          //正式代码\n          window.location.href = res.data\n        }\n      })\n        .catch(err => console.error(err))\n    },\n    \n    getUserInfo() {\n      userInfo({ userNo: this.userNo }).then((res) => {\n        console.log('获取用户信息getUserInfo', res)\n        this.SET_USER_INFO(res.data)\n        this.userId = res.data.id\n        this.getIdPowerList()\n      })\n    },\n    GetQueryString(name) {\n      const reg = new RegExp(`(^|&)${name}=([^&]*)(&|$)`)\n      const r = window.location.search.substr(1).match(reg)\n      if (r != null) return unescape(r[2])\n      return ''\n    },\n        // id获取权限\n    getIdPowerList() {\n      idPowerList({ id: this.userId }).then((res) => {\n        \n        this.$store.commit('SET_LIST_POWER', res)\n        // eslint-disable-next-line array-callback-return\n        this.OTarrName.map((d, idx) => {\n          this.OTarrType[idx] = res.OTarr.indexOf(d) > -1\n        })\n        console.log('getIdPowerList',this.OTarrType)\n\n        ///获取权限\n        this.$store.commit('SET_HOME_POWER', this.OTarrType)\n        // this.\n      })\n    },\n  },\n}\n</script>\n"]}]}