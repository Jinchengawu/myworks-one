{"remainingRequest":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhanyuan/code/oc-works/fuli/src/views/Home/Home.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhanyuan/code/oc-works/fuli/src/views/Home/Home.vue","mtime":1564134165917},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/oc-works/fuli/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\n// @ is an alias to /src\nimport { isNull,addMark } from '@/utils'\nimport HomeSearch from './Home-search.vue'\nimport tabDynamic from '../customerManagement/tab-dynamic.vue'\nimport { homeList, powerList, idPowerList, logList,homeLists} from '@/service/home'\nimport { messageList,addMessages } from '@/service/customer'\nimport { setTimeout, clearTimeout } from 'timers'\nvar t = null\n\nexport default {\n  name: 'Home',\n  components: {\n    'home-search': HomeSearch,\n    'tab-dynamic':tabDynamic\n  },\n  data() {\n    return {\n      active:0,\n      tabIndex: 1,\n      loading: false,\n      finished: false,\n      finished_text: '没有更多数据啦',\n      PermissionObj:this.$store.state.powerList.PermissionObj,///权限\n      error: false,\n      searchObj: {},\n      cpSearchObj: {},\n      messageBoard: false,\n      AddmessageBoard: false,\n      messageStr: '',\n      messageError: false,\n      homeListData: [],\n      page:1,\n      size:5,\n      total: null,\n      loadType: false,\n      PreviousPage: 0,\n      OTarrType:['1','2'],\n      OTarrName: ['企业列表', '动态列表'],\n      isWX: '',\n      logDList: [],\n      pageLog: 1,\n      totalLog: null,\n      finishedLog: false,\n      loadingLog: false,\n      setingItem:{},//选中某条动态\n      setingMessage:{},//选中某条留言\n      MessageList:[],//留言列表\n    }\n  },\n  watch:{\n    active(newV,oldV){\n      // console.log('active','n=',newV,'o=',oldV)\n      this.$store.commit('SET_HOME_ACTIVE',newV)\n      return \n    }\n  },\n  created() {      \n    this.active = this.$store.getters.homeActive\n  },\n  mounted() {\n    let that = this         \n    this.PermissionObj = this.$store.state.powerList.PermissionObj\n    \n  }, \n  destroyed() {    \n  },\n  updated(){\n    this.getOTarrType()\n  },\n  methods: {  \n     //获取当前home权限  \n    getOTarrType(){           \n      let OTarrTypes = this.$store.getters.homePower          \n      if(OTarrTypes){\n        this.OTarrType = OTarrTypes\n        // console.log('OTarrTypes',OTarrTypes)\n        return true\n      }else{\n        this.getOTarrType()\n        return false     \n      }      \n    },\n    // 加载数据\n    onLoad() {\n      const that = this\n      if (this.tabIndex === 1) {\n        if (this.homeListData.length === this.total) {\n          this.finished = true // 数据全部加载完成\n          this.loading = false// 加载状态结束\n          return\n        }\n      }\n      // 下拉加载事件\n      if (that.tabIndex === 1) {\n        setTimeout(() => {\n          that.getHomeData()\n        }, 1000)\n      }\n    },\n         \n    // 获取数据\n    getHomeData() {\n      let parmes = {...this.searchObj}\n      parmes.page = this.page\n      parmes.size = this.size\n      // console.log('parmes', parmes)\n      homeLists(parmes).then((res) => {\n        res.data.data = res.data.data ? res.data.data : []\n        this.homeListData = this.homeListData.concat(res.data.data)\n        this.total = res.data.total\n        // eslint-disable-next-line no-plusplus\n        this.page++\n        this.loading = false// 加载状态结束\n      })\n    },\n    formatter(type, value) {\n      if (type === 'year') {\n        return `${value}年`\n      } if (type === 'month') {\n        return `${value}月`\n      }\n      return value\n    },\n    goCustomer(id) {\n      ///权限处理\n      if(isNull(this.$store.state.powerList.PermissionObj['compaylist_list'])){\n        return\n      }\n      this.$router.push({\n        path: '/customer',\n        query: {\n          id,\n        },\n      })\n    },\n    \n    // 控制筛选\n    getSearch(data) {\n      // console.log('动态列表控制筛选',data)\n      this.searchObj = data      \n      let searchType = false // search是否变化\n      this.homeListData = []\n        this.page = 1\n        this.total = null\n        this.loading = true\n      this.finished_text = ''\n      this.pageLog  = 1\n      this.onLoad()\n    },\n    // 控制筛选    \n    clearDataSearch(data) {\n      // 清除筛选数据\n      this.getSearch()\n      \n    },\n    addMessage(item) {\n      // console.log('item',item)\n      this.setingItem = item\n      this.messageBoard = false\n      setTimeout(() => {\n        // 加载状态结束\n        this.AddmessageBoard = true\n      }, 300)\n    },\n    messageClear() {\n      // 留言板取消事件\n      this.AddmessageBoard = false\n      this.messageStr = ''\n      this.setingItem = {}\n    },\n    routerTo() {\n      this.$router.push('/addCustomer')\n      // to=\n    },        \n    //排序\n    runSort(e){\n       this.homeListData = this.homeListData.reverse()\n    }\n  },\n}\n",{"version":3,"sources":["Home.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Home.vue","sourceRoot":"src/views/Home","sourcesContent":["<template>\n  <div class=\"home\">\n    <!-- <div>ISWX:{{ isWX }}</div> -->\n    <van-tabs\n      v-model=\"active\"\n      color=\"#03C061\"\n      sticky\n      swipeable\n    >\n      <van-tab\n        v-if=\"OTarrType[0]\"\n        title=\"企业列表\"\n      >\n        <div class=\"contact\">\n          <!-- 筛选-->\n\n          <home-search\n            :tab-index=\"tabIndex\"\n            :is-sort=\"true\"\n            :is-money=\"true\"\n            @postSearch=\"getSearch($event)\"\n            @clearSearch=\"clearDataSearch($event)\"\n            @_runSort=\"runSort($event)\"\n          />\n\n          <!-- 内容部分 -->\n          <div class=\"contact_container\">\n            <div class=\"container\">\n              <div class=\"header\">\n                共{{ total }}条客户数据\n              </div>\n              <van-list\n                v-model=\"loading\"\n                :finished=\"finished\"\n                :finished-text=\"finished_text\"\n                :error.sync=\"error\"\n                error-text=\"请求失败，点击重新加载\"\n                @load=\"onLoad()\"\n              >\n                <div\n                  v-for=\"(item,idx) in homeListData\"\n                  :key=\"idx\"\n                  class=\"item-list\"\n                  @click=\"goCustomer(item.companyId)\"\n                >\n                  <h4 class=\"text_h4\">\n                    {{ item.companyName }}\n                  </h4>\n                  <p class=\"text_p\">\n                    {{ item.companyIndustry }}\n                  </p>\n                  <!-- <p class=\"text_p\">\n                    {{ item.dayed }}天未跟进\n                  </p> -->\n                  <p class=\"text_p\">\n                    最后跟进时间：{{ item.finalFollowUpTime }}\n                  </p>\n                  <p class=\"text_p\">\n                    最后操作人：{{ item.operatorName }}\n                  </p>\n                  <p class=\"text_p\">\n                    最后事件：{{ item.actionType }}\n                  </p>\n                </div>\n              </van-list>\n            </div>\n\n            <!-- 录入新客户 -->\n            <div\n              v-if=\"$store.state.powerList.PermissionObj['concatinfo_insert'] != undefined\"\n              class=\"contact_bottom\"\n            >\n              <van-button\n                class=\"btn gradual-btn\"\n                type=\"primary\"\n                @click=\"routerTo\"\n              >\n                录入新客户\n              </van-button>\n            </div>\n          </div>\n        </div>\n      </van-tab>\n\n      <!-- ///////第二页///////////////////// -->\n      <van-tab\n        v-if=\"OTarrType[1]\"\n        title=\"动态列表\"\n      >\n        <tab-dynamic\n          v-if=\"OTarrType[1]&&active==1\"\n          :search-type=\"1\"\n        />\n      </van-tab>\n    </van-tabs>\n  </div>\n</template>\n\n<script>\n// @ is an alias to /src\nimport { isNull,addMark } from '@/utils'\nimport HomeSearch from './Home-search.vue'\nimport tabDynamic from '../customerManagement/tab-dynamic.vue'\nimport { homeList, powerList, idPowerList, logList,homeLists} from '@/service/home'\nimport { messageList,addMessages } from '@/service/customer'\nimport { setTimeout, clearTimeout } from 'timers'\nvar t = null\n\nexport default {\n  name: 'Home',\n  components: {\n    'home-search': HomeSearch,\n    'tab-dynamic':tabDynamic\n  },\n  data() {\n    return {\n      active:0,\n      tabIndex: 1,\n      loading: false,\n      finished: false,\n      finished_text: '没有更多数据啦',\n      PermissionObj:this.$store.state.powerList.PermissionObj,///权限\n      error: false,\n      searchObj: {},\n      cpSearchObj: {},\n      messageBoard: false,\n      AddmessageBoard: false,\n      messageStr: '',\n      messageError: false,\n      homeListData: [],\n      page:1,\n      size:5,\n      total: null,\n      loadType: false,\n      PreviousPage: 0,\n      OTarrType:['1','2'],\n      OTarrName: ['企业列表', '动态列表'],\n      isWX: '',\n      logDList: [],\n      pageLog: 1,\n      totalLog: null,\n      finishedLog: false,\n      loadingLog: false,\n      setingItem:{},//选中某条动态\n      setingMessage:{},//选中某条留言\n      MessageList:[],//留言列表\n    }\n  },\n  watch:{\n    active(newV,oldV){\n      // console.log('active','n=',newV,'o=',oldV)\n      this.$store.commit('SET_HOME_ACTIVE',newV)\n      return \n    }\n  },\n  created() {      \n    this.active = this.$store.getters.homeActive\n  },\n  mounted() {\n    let that = this         \n    this.PermissionObj = this.$store.state.powerList.PermissionObj\n    \n  }, \n  destroyed() {    \n  },\n  updated(){\n    this.getOTarrType()\n  },\n  methods: {  \n     //获取当前home权限  \n    getOTarrType(){           \n      let OTarrTypes = this.$store.getters.homePower          \n      if(OTarrTypes){\n        this.OTarrType = OTarrTypes\n        // console.log('OTarrTypes',OTarrTypes)\n        return true\n      }else{\n        this.getOTarrType()\n        return false     \n      }      \n    },\n    // 加载数据\n    onLoad() {\n      const that = this\n      if (this.tabIndex === 1) {\n        if (this.homeListData.length === this.total) {\n          this.finished = true // 数据全部加载完成\n          this.loading = false// 加载状态结束\n          return\n        }\n      }\n      // 下拉加载事件\n      if (that.tabIndex === 1) {\n        setTimeout(() => {\n          that.getHomeData()\n        }, 1000)\n      }\n    },\n         \n    // 获取数据\n    getHomeData() {\n      let parmes = {...this.searchObj}\n      parmes.page = this.page\n      parmes.size = this.size\n      // console.log('parmes', parmes)\n      homeLists(parmes).then((res) => {\n        res.data.data = res.data.data ? res.data.data : []\n        this.homeListData = this.homeListData.concat(res.data.data)\n        this.total = res.data.total\n        // eslint-disable-next-line no-plusplus\n        this.page++\n        this.loading = false// 加载状态结束\n      })\n    },\n    formatter(type, value) {\n      if (type === 'year') {\n        return `${value}年`\n      } if (type === 'month') {\n        return `${value}月`\n      }\n      return value\n    },\n    goCustomer(id) {\n      ///权限处理\n      if(isNull(this.$store.state.powerList.PermissionObj['compaylist_list'])){\n        return\n      }\n      this.$router.push({\n        path: '/customer',\n        query: {\n          id,\n        },\n      })\n    },\n    \n    // 控制筛选\n    getSearch(data) {\n      // console.log('动态列表控制筛选',data)\n      this.searchObj = data      \n      let searchType = false // search是否变化\n      this.homeListData = []\n        this.page = 1\n        this.total = null\n        this.loading = true\n      this.finished_text = ''\n      this.pageLog  = 1\n      this.onLoad()\n    },\n    // 控制筛选    \n    clearDataSearch(data) {\n      // 清除筛选数据\n      this.getSearch()\n      \n    },\n    addMessage(item) {\n      // console.log('item',item)\n      this.setingItem = item\n      this.messageBoard = false\n      setTimeout(() => {\n        // 加载状态结束\n        this.AddmessageBoard = true\n      }, 300)\n    },\n    messageClear() {\n      // 留言板取消事件\n      this.AddmessageBoard = false\n      this.messageStr = ''\n      this.setingItem = {}\n    },\n    routerTo() {\n      this.$router.push('/addCustomer')\n      // to=\n    },        \n    //排序\n    runSort(e){\n       this.homeListData = this.homeListData.reverse()\n    }\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.contact_container {\n  width: 100%;\n  .container {\n    width: 100%;\n    padding: 0 10px;\n    box-sizing: border-box;\n    margin-bottom: 72px;\n    .header {\n      width: 100%;\n      height: 35px;\n      line-height: 35px;\n      color: #999999;\n      font-size: 12px;\n    }\n    .item-list {\n      width: 100%;\n      background: #ffffff;\n      box-shadow: 0 2px 8px 0 rgba(153, 153, 153, 0.24);\n      border-radius: 5px;\n      padding: 20px;\n      box-sizing: border-box;\n      margin-bottom: 10px;\n      .text_h4 {\n        margin-bottom: 10px;\n        color: #000000;\n        font-size: 16px;\n        font-weight: bolder;\n      }\n      .text_p {\n        width: 100%;\n        height: 25px;\n        line-height: 25px;\n        color: #333333;\n        font-size: 12px;\n      }\n    }\n  }\n  .contact_bottom {\n    width: 100%;\n    height: 72px;\n    position: fixed;\n    z-index: 9;\n    bottom: 0;\n    padding: 0 10px;\n    background: #fcfcfc;\n    box-sizing: border-box;\n    .btn {\n      width: 100%;\n      margin-top: 10px;\n    }\n  }\n}\n.contact_container_er {\n  width: 100%;\n  padding: 10px 20px 0 20px;\n  box-sizing: border-box;\n  .time {\n        width: 100%;\n        height: 35px;\n        line-height: 35px;\n        color: #626262;\n        font-size: 12px;\n      }\n  .item-list {\n    width: 100%;\n    display: flex;\n    box-sizing: border-box;\n    .item-left {\n      width: 24px;\n      margin-right: 10px;\n      position: relative;\n      .actived {\n        background: #03c061 !important;\n      }\n      .xianTop{\n        height: 50% !important;\n      }\n      .xianBottom{\n        height: 50% !important;\n        top:0 !important;\n      }\n      .xian {\n        width: 2px;\n        height: 100%;\n        position: absolute;\n        bottom: 0;\n        left: 11px;\n        background: #dddddd;\n      }\n      .circular {\n        width: 24px;\n        height: 24px;\n        border-radius: 12px;\n        background: #dddddd;\n        position: absolute;\n        bottom: 50%;\n        left: 0px;\n      }\n    }\n\n    .item-right {\n      min-width: 0;\n      flex: 1;\n      padding-bottom: 20px;\n\n      .right {\n        width: 100%;\n        background: #ffffff;\n        box-shadow: 0 2px 8px 0 rgba(153, 153, 153, 0.24);\n        border-radius: 8px;\n        .top {\n          width: 100%;\n          box-sizing: border-box;\n          padding: 10px 20px;\n          position: relative;\n          .text_h4 {\n            margin-bottom: 10px;\n            color: #03c061;\n            font-size: 16px;\n            font-weight: bolder;\n          }\n          .text_p {\n            width: 100%;\n            height: 25px;\n            line-height: 25px;\n            color: #333333;\n            font-size: 12px;\n          }\n        }\n        .message {\n          width: 100%;\n          padding: 5px 5px 8px 5px;\n          box-sizing: border-box;\n          border-top: 1px dashed #dddddd;\n          top: 10px;\n          display: flex;\n          position: relative;\n          .message-left {\n            width: 60%;\n            height: 20px;\n            line-height: 20px;\n            font-size: 12px;\n            color: #333333;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n            min-width: 0;\n          }\n          .message-right {\n            // width: 35%;\n            height: 20px;\n            min-width: 0;\n            line-height: 20px;\n            text-align: right;\n            font-size: 12px;\n            color: #333333;\n          }\n        }\n      }\n    }\n  }\n}\n.messageBoard {\n  width: 240px;\n  .header {\n    width: 90%;\n    margin: 0 auto;\n    height: 40px;\n    font-size: 16px;\n    font-weight: bold;\n    line-height: 40px;\n    text-align: center;\n    border-bottom: 1px solid #dddddd;\n    position: relative;\n    .header-btn {\n      position: absolute;\n      right: 0;\n      top: 0;\n      color: #00703a;\n      font-size: 14px;\n      font-weight: normal;\n    }\n  }\n  .container {\n    width: 90%;\n    margin: 0 auto;\n    min-height: 150px;\n    border-bottom: 1px solid #dddddd;\n    .container_header {\n      width: 100%;\n      height: 35px;\n      line-height: 35px;\n      color: #626262;\n      font-size: 12px;\n    }\n    .container_p {\n      width: 100%;\n      line-height: 20px;\n      color: #333333;\n      font-size: 12px;\n    }\n    textarea {\n      width: 100%;\n      max-height: 120px;\n      min-height: 120px;\n      padding: 10px;\n      font-size: 12px;\n      box-sizing: border-box;\n      outline: none;\n      resize: none;\n      overflow-y: auto;\n    }\n    .textarea_no {\n      border: 1px solid #ff0021;\n    }\n    .textarea_yes {\n      border: 1px solid #999999;\n    }\n  }\n}\n</style>\n"]}]}