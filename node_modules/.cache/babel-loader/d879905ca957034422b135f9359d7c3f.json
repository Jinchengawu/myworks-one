{"remainingRequest":"/Users/wangzhanyuan/code/my-works/one/node_modules/babel-loader/lib/index.js!/Users/wangzhanyuan/code/my-works/one/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wangzhanyuan/code/my-works/one/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wangzhanyuan/code/my-works/one/src/views/AfterLoanManagement/loadThree.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wangzhanyuan/code/my-works/one/src/views/AfterLoanManagement/loadThree.vue","mtime":1564134165915},{"path":"/Users/wangzhanyuan/code/my-works/one/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/my-works/one/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/my-works/one/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wangzhanyuan/code/my-works/one/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.function.name\";\nimport _objectSpread from \"/Users/wangzhanyuan/code/my-works/one/node_modules/@babel/runtime-corejs2/helpers/esm/objectSpread\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import { api, get } from \"@service\";\n// import { mapState, mapMutations } from 'vuex'\n// import { formatDate, isNull } from '@/utils'\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport HomeSearch from '@views/Home/Home-search.vue';\nimport { rentBackFilePage, updateRentBackFileById, addRentBack } from '@/service/loan.js';\nimport { upload } from '@/service/customer';\nimport { formatDate } from '@/utils';\nexport default {\n  name: 'LoadThree',\n  components: {\n    'home-search': HomeSearch\n  },\n  data: function data() {\n    return {\n      PermissionObj: this.$store.state.powerList.PermissionObj,\n      ///权限\n      active: 0,\n      popShow: false,\n      tab2: 2,\n      tabIndex: 1,\n      userList: [],\n      rentBackTypeList: [{\n        name: '请选择类型',\n        val: ''\n      }, {\n        name: '财务类型',\n        val: 0\n      }, {\n        name: '基础类型',\n        val: 1\n      }, {\n        name: '征信报告',\n        val: 2\n      }, {\n        name: '其他类',\n        val: 3\n      }],\n      LoanedList: [],\n      totalLog: null,\n      loadingLog: false,\n      finishedLog: false,\n      finished_text: '没有更多数据啦',\n      error: false,\n      pageLog: 1,\n      size: 5,\n      newFile: null,\n      rentBackType: '',\n      search: {\n        slt: ''\n      },\n      show: false\n    };\n  },\n  computed: {},\n  created: function created() {\n    this.selectInput = '777';\n  },\n  methods: {\n    changSearch: function changSearch() {},\n    //下载\n    download: function download(itm) {\n      console.log('itm', itm);\n      var baseUrl = this.$baseUrl() + itm.filePath + '&filename=' + itm.fileName;\n      window.open(baseUrl);\n    },\n    showPop: function showPop() {\n      this.popShow = true;\n    },\n    //'删除文件'\n    deleteFile: function deleteFile() {\n      var _this = this;\n\n      console.log('this.delItm', this.delItm);\n      updateRentBackFileById({\n        id: this.delItm.id\n      }).then(function (res) {\n        // console.log('删除文件',res)\n        _this.LoanedList.map(function (d, idx) {\n          if (d.id == _this.delItm.id) {\n            _this.LoanedList.splice(idx, 1);\n          }\n        });\n\n        _this.boxShow();\n      });\n    },\n    getSearch: function getSearch(data) {\n      this.searchObj = data;\n      console.log(this.searchObj);\n      this.searchObj = data;\n      var searchType = false; // search是否变化\n\n      this.LoanedList = [];\n      this.totalLog = null;\n      this.loadingLog = true;\n      this.finished_text = '';\n      this.pageLog = 1;\n      this.onLoad();\n    },\n    clearDataSearch: function clearDataSearch(data) {\n      // 清除筛选数据\n      if (data === 1) {// eslint-disable-next-line no-alert\n        // 企业列表\n      } else {// 动态列表\n        }\n    },\n    // 加载数据\n    onLoad: function onLoad() {\n      var that = this; // console.log(this.LoanedList.length , this.totalLog)\n\n      if (this.LoanedList.length === this.totalLog) {\n        this.finishedLog = true; // 数据全部加载完成\n\n        this.loadingLog = false; // 加载状态结束\n\n        this.finished_text = '没有更多数据';\n        return;\n      } // 下拉加载事件\n\n\n      setTimeout(function () {\n        that.getLoanedList();\n      }, 1000);\n    },\n    //获取当前数据列表\n    getLoanedList: function getLoanedList() {\n      var _this2 = this;\n\n      var params = _objectSpread({}, this.searchObj);\n\n      params.projectId = this.$route.query.projectId, params.fileType = 1, params.page = this.pageLog, params.size = this.size;\n      rentBackFilePage(params).then(function (res) {\n        _this2.LoanedList = _this2.LoanedList.concat(res.data);\n\n        _this2.LoanedList.map(function (d) {\n          if (d.rentBackType == 1) {\n            d.rentBackType = '基础类型';\n          } else if (d.rentBackType == 2) {\n            d.rentBackType = '征信报告';\n          } else if (d.rentBackType == 3) {\n            d.rentBackType = '其他类';\n          } else if (d.rentBackType == 0) {\n            d.rentBackType = '财务类型';\n          }\n        });\n\n        _this2.totalLog = res.total;\n        _this2.pageLog += 1;\n        _this2.loadingLog = false; // 加载状态结束\n        // this.quoteList = addMark(this.quoteList,3)  \n      });\n    },\n    update: function update(e) {\n      var _this3 = this;\n\n      var file = e.target.files[0];\n      var param = new FormData();\n      param.append('file', file);\n      var userData = this.$store.getters.userData;\n      var fileName = userData.companyAbbreviation + '-' + userData.companyBusinessLicense + '-' + formatDate(new Date(), 'yyyyMMdd');\n      var config = {\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      };\n      this.$toast.loading({\n        mask: true,\n        message: '上传中...',\n        duration: 100000\n      });\n      upload(param, config).then(function (res) {\n        console.log('上传文件', res.data);\n        _this3.newFile = res.data;\n        var name = file.name;\n        console.log(name);\n\n        _this3.$toast.clear(); // console.log('文件相关',param, )\n\n\n        _this3.fileTypeName = name.slice(name.lastIndexOf('.'), name.length);\n\n        if (res.data) {\n          _this3.userList.push({\n            path: res.data.url,\n            name: fileName + _this3.fileTypeName\n          });\n        }\n      });\n    },\n    deleteItem: function deleteItem(idx) {\n      console.log(idx);\n      this.userList.splice(idx, 1);\n    },\n    //新增贷后资料\n    addSearon: function addSearon() {\n      var _this4 = this;\n\n      if (!this.newFile) return;\n      var params = this.userList;\n      params.map(function (d) {\n        d.fileName = d.name;\n        d.filePath = d.path;\n        d.projectId = _this4.$route.query.projectId;\n        d.fileType = 1;\n        d.lendingId = _this4.$route.query.id;\n        d.timeQuarter = _this4.isQuarter;\n        d.rentBackType = _this4.rentBackType;\n        d.userId = _this4.$store.getters.userInfo.id;\n        d.companyId = _this4.$store.getters.userData.companyId;\n      });\n      var paramss = {\n        rentBackFileDTOList: params\n      };\n      addRentBack(paramss).then(function (res) {\n        console.log('新增季度检查', res);\n\n        _this4.$notifySty('添加成功');\n\n        _this4.addTrue();\n      });\n    },\n    //增加成功后的衔接操作\n    addTrue: function addTrue() {\n      this.pageLog = 1;\n      this.size = 5;\n      this.totalLog = null;\n      this.$set(this, 'LoanedList', []);\n      this.loadingLog = true; // 加载状态启动\n\n      this.finished_text = '';\n      this.popShow = false;\n      this.userList = [];\n      this.rentBackType = '';\n      this.onLoad();\n    },\n    boxShow: function boxShow(itm) {\n      this.show = !this.show;\n      if (!this.show) this.delItm = null;else this.delItm = itm;\n      console.log('this.delItm', this.delItm);\n    }\n  }\n};",{"version":3,"sources":["loadThree.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div name=\"loadThree\">\n    <div class=\"contact_container5\">\n      <van-popup\n        v-model=\"show\"\n        class=\"Tit-box\"\n      >\n        <div class=\"Tit-box-title\">\n          提示\n        </div>\n        <div class=\"Tit-box-cont\">\n          确认删除？\n        </div>\n        <div class=\"Tit-box-buts\">\n          <van-button\n            class=\"Tit-box-but\"\n            square\n            type=\"primary\"\n            @click=\"deleteFile\"\n          >\n            确认\n          </van-button>\n          <van-button\n            class=\"Tit-box-but\"\n            square\n            @click=\"boxShow\"\n          >\n            取消\n          </van-button>\n        </div>\n      </van-popup>\n      <!-- <span >弹窗</span> -->\n      <van-popup\n        v-model=\"popShow\"\n        class=\"class-pop\"\n      >\n        <div class=\"pop-box\">\n          <div>\n            <!-- <span></span> -->\n            <div class=\"search-item\">\n              <div class=\"left text-bold\">\n                请选择类型\n              </div>\n              <div class=\"right\">\n                <select\n                  v-if=\"tabIndex == 1\"\n                  v-model=\"rentBackType\"\n                  v-placeholder=\"'请选择类型'\"\n                >\n                  <option\n                    v-for=\"(itm,idx) in rentBackTypeList\"\n                    :key=\"idx\"\n                    :value=\"itm.val\"\n                  >\n                    {{ itm.name }}\n                  </option>\n                </select>\n              </div>\n            </div>\n          </div>\n          <div style=\"margin-bottom:2.5%;display:flex;\">\n            <span\n              class=\"text-bold text14\"\n              style=\"margin-right:4%;\"\n            >请选择所需上传附件</span>            \n            <div\n              class=\"text14 theme-colors \"\n              style=\"position: relative;\"\n            >\n              打开手机\n              <input\n                class=\"file\"\n                name=\"file\"\n                type=\"file\"\n                @change=\"update\"\n              >\n            </div>\n          </div>\n          <div class=\"user-list\">\n            <div\n              v-for=\"(item,index) in userList\"\n              :key=\"index\"\n              class=\"user-item\"\n            >\n              <span>{{ item.name }}</span>\n              <van-icon\n                style=\"line-height:50px;margin-right: 2.6%;\"\n                class=\"theme-colors\"\n                name=\"delete\"\n                @click=\"deleteItem(index)\"\n              />\n            </div>\n          </div>\n\n          <div class=\"text12 text-color999 pop-box-txt\">\n            <div>上传合同附件需要符合命名规则，否则会提示修改:</div>\n            <div>命名规则如下</div>\n            <div>客户简称+统一信用代码+年月日（20180808）</div>\n          </div>\n        </div>\n        <van-button\n          class=\"gradual-btn\"\n          style=\"width:100%;\"\n          type=\"primary\"\n          @click=\"addSearon\"\n        >\n          上传资料\n        </van-button>\n      </van-popup>\n      <div class=\"tab5_box\">\n        <home-search\n          :tab-index=\"3\"\n          :is-time=\"true\"\n          :is-search=\"true\"\n          @postSearch=\"getSearch($event)\"\n          @clearSearch=\"clearDataSearch($event)\"\n        />\n        <van-list\n          v-model=\"loadingLog\"\n          :finished=\"finishedLog\"\n          :finished-text=\"finished_text\"\n          :error.sync=\"error\"\n          error-text=\"请求失败，点击重新加载\"\n          @load=\"onLoad()\"\n        >\n          <div\n            v-for=\"(itm,idx) in LoanedList\"\n            :key=\"idx\"\n            class=\"tab5-list\"\n          >\n            <div class=\"tab5-list-tilte\">\n              <p class=\"span1\">\n                {{ itm.fileName }}\n              </p>\n            </div>\n            <div class=\"tab5-list-p\">\n              类型:{{ itm.rentBackType }}\n            </div>\n            <div class=\"tab5-list-p\">\n              <span class=\"span-left\">上传时间:{{ itm.createTime }} 上传人:{{ itm.name }}</span>\n            </div>\n            <span\n              class=\"iconfont iconicon_load theme-colors icon1\"\n              @click=\"download(itm)\"\n            />\n            <span\n              class=\"iconfont iconshanchu theme-colors icon2\"\n              @click=\"boxShow(itm)\"\n            />\n          </div>\n        </van-list>\n      </div>\n      <div\n        v-if=\"PermissionObj['afterloan_file_insert'] != undefined\"\n        class=\"tab-footer\"\n      >\n        <van-button\n          class=\"gradual-btn\"\n          style=\"width:100%;\"\n          type=\"primary\"\n          @click=\"showPop\"\n        >\n          上传资料\n        </van-button>\n      </div>\n    </div>\n  </div>\n</template>\n<script>\n// import { api, get } from \"@service\";\n// import { mapState, mapMutations } from 'vuex'\n// import { formatDate, isNull } from '@/utils'\n// eslint-disable-next-line import/no-extraneous-dependencies\nimport HomeSearch from '@views/Home/Home-search.vue'\nimport { rentBackFilePage,updateRentBackFileById,addRentBack } from '@/service/loan.js'\nimport { upload  } from '@/service/customer'\nimport { formatDate } from '@/utils'\nexport default {\n  name: 'LoadThree',\n  components: {\n    'home-search': HomeSearch,\n  },\n  data() {\n    return {\n      PermissionObj:this.$store.state.powerList.PermissionObj,///权限\n      active: 0,\n      popShow: false,\n      tab2: 2,\n      tabIndex: 1,\n      userList: [ ],\n      rentBackTypeList:[\n        { name:'请选择类型',val:''},\n        { name:'财务类型',val:0},\n        { name:'基础类型',val:1},\n        { name:'征信报告',val:2},\n        { name:'其他类',val:3},\n      ],\n      LoanedList:[],\n      totalLog: null,\n      loadingLog: false,\n      finishedLog: false,\n      finished_text: '没有更多数据啦',\n      error: false,\n      pageLog: 1,\n      size: 5,\n      newFile:null,\n      rentBackType:'',\n      search:{\n        slt:''\n      },\n      show:false\n    }\n  },\n  computed: {\n\n  },\n  created() {\n    this.selectInput = '777'\n  },\n  methods: {\n    changSearch() { },\n    //下载\n    download(itm){\n      console.log('itm',itm)\n      let baseUrl = this.$baseUrl()+itm.filePath+'&filename='+itm.fileName\n      window.open(baseUrl)\n    },\n    showPop() {\n      this.popShow = true\n    },\n    \n    //'删除文件'\n    deleteFile(){\n      console.log('this.delItm',this.delItm)\n      updateRentBackFileById({id:this.delItm.id}).then(res=>{\n        // console.log('删除文件',res)\n        this.LoanedList.map((d,idx)=>{\n          if(d.id==this.delItm.id){ \n            this.LoanedList.splice(idx,1)\n          }          \n        })\n        this.boxShow()\n      })\n    },\n    getSearch(data) {\n      this.searchObj = data\n      console.log(this.searchObj)\n      this.searchObj = data      \n      let searchType = false // search是否变化\n      this.LoanedList = []\n        this.totalLog = null\n        this.loadingLog = true\n      this.finished_text = ''\n      this.pageLog  = 1\n      this.onLoad()\n    },\n    clearDataSearch(data) {\n      // 清除筛选数据\n      if (data === 1) {\n        // eslint-disable-next-line no-alert\n        \n        // 企业列表\n      } else {\n        // 动态列表\n      }\n    },\n    // 加载数据\n    onLoad() {\n      const that = this\n      // console.log(this.LoanedList.length , this.totalLog)\n      if (this.LoanedList.length === this.totalLog) {\n        this.finishedLog = true // 数据全部加载完成\n        this.loadingLog = false// 加载状态结束\n        this.finished_text = '没有更多数据'\n        return\n      }\n      // 下拉加载事件\n      setTimeout(() => {\n        that.getLoanedList()\n      }, 1000)      \n    },\n    //获取当前数据列表\n    getLoanedList() {\n      let params = {...this.searchObj}\n        params.projectId = this.$route.query.projectId,\n        params.fileType=1,\n        params.page=this.pageLog,\n        params.size=this.size\n      \n      rentBackFilePage(params).then((res) => {        \n        this.LoanedList = this.LoanedList.concat(res.data)\n        this.LoanedList.map(d=>{\n          if(d.rentBackType == 1){\n            d.rentBackType = '基础类型'\n          }else if(d.rentBackType == 2){\n            d.rentBackType = '征信报告'\n          }else if(d.rentBackType == 3){\n            d.rentBackType = '其他类'\n          }else if(d.rentBackType == 0){\n            d.rentBackType = '财务类型'\n          }\n        })\n        this.totalLog = res.total\n        this.pageLog += 1\n        this.loadingLog = false// 加载状态结束\n        // this.quoteList = addMark(this.quoteList,3)  \n      })\n    },\n    update(e) {\n      let file = e.target.files[0]\n      let param = new FormData()\n      param.append('file', file)\n      let userData = this.$store.getters.userData\n      let fileName = userData.companyAbbreviation+'-'+userData.companyBusinessLicense+'-'+ formatDate(new Date(),'yyyyMMdd') \n      \n      let config = {\n        headers: { 'Content-Type': 'multipart/form-data' }\n      }\n      this.$toast.loading({\n        mask: true,\n        message: '上传中...',\n        duration:100000\n      })\n      upload(param, config)\n        .then(res => {\n          console.log('上传文件', res.data)\n          this.newFile=res.data\n          let name = file.name\n          console.log(name)\n          \n          this.$toast.clear()\n          // console.log('文件相关',param, )\n          this.fileTypeName = name.slice(name.lastIndexOf('.'),name.length)\n          if(res.data){\n            this.userList.push({path:res.data.url,name:fileName+this.fileTypeName})\n          }\n          \n        })\n    },\n    deleteItem(idx){\n      console.log(idx)\n      this.userList.splice(idx,1)\n    },\n    //新增贷后资料\n    addSearon(){\n      if(!this.newFile) return    \n      let params = this.userList\n      params.map(d=>{\n        d.fileName=d.name\n        d.filePath=d.path\n        d.projectId=this.$route.query.projectId\n        d.fileType=1\n        d.lendingId=this.$route.query.id\n        d.timeQuarter=this.isQuarter\n        d.rentBackType=this.rentBackType\n        d.userId=this.$store.getters.userInfo.id\n        d.companyId=this.$store.getters.userData.companyId\n      })\n      let paramss = {\n        rentBackFileDTOList:params\n      }\n      \n      addRentBack(paramss).then(res=>{\n        console.log('新增季度检查',res)\n        this.$notifySty('添加成功') \n        this.addTrue()       \n      })\n    },\n    //增加成功后的衔接操作\n    addTrue(){      \n      this.pageLog = 1\n      this.size = 5\n      this.totalLog = null\n      this.$set(this,'LoanedList',[])\n      this.loadingLog = true// 加载状态启动\n      this.finished_text = ''\n      this.popShow = false\n      this.userList = []\n      this.rentBackType = ''\n      this.onLoad()\n    },\n    boxShow(itm){\n      this.show = !this.show\n      if(!this.show)this.delItm = null\n      else this.delItm = itm\n      console.log('this.delItm',this.delItm)\n    },\n  },\n}\n</script>\n<style lang=\"less\" scoped>\n.file{\n  width: 100%;\n  height: 100%;\n  position: absolute;\n  left: 0;\n  top: 0;\n  opacity: 0;\n}\n.contact_container5 {\n  .Tit-box{\n    width: 70%;    \n    .Tit-box-title{\n      line-height: 30px;\n      font-size: 14px;\n      text-align: center;\n    }\n    .Tit-box-cont{\n      line-height: 80px;\n      margin-top: -10px;\n      font-size: 15px;\n      text-align: center;\n    }\n    .Tit-box-buts{\n      display: flex;\n      justify-content: space-between;\n    }\n    .Tit-box-but{\n      flex: 1;\n    }\n  }\n  .text-bold {\n    font-weight: bold;\n  }\n  width: 100%;\n  padding: 10px 10px 70px 10px;\n  box-sizing: border-box;\n  .user-list {\n    border: 1px solid #dddddd;\n    margin-bottom: 2.6%;\n  }\n  .user-item {\n    height: 50px;\n    display: flex;\n    justify-content: space-between;\n    padding-left: 2.7%;\n    span {\n      font-family: PingFangSC-Regular;\n      font-size: 12px;\n      color: #333333;\n      letter-spacing: 0.1px;\n      line-height: 50px;\n    }\n  }\n  .user-list div:nth-child(2n-1) {\n    background: #f3f3f3;\n  }\n\n  .class-pop {\n    width: 85%;\n    .pop-box {\n      padding: 4.2% 5.3%;\n      .search-item {\n        margin-top: 4.2%;\n        width: 100%;\n        display: flex;\n        height: 35px;\n        line-height: 35px;\n        margin-bottom: 15px;\n        .left {\n          width: 100px;\n          height: 35px;\n          font-size: 14px;\n          color: #333333;\n        }\n        .right {\n          width: 190px;\n          height: 35px;\n          display: flex;\n          .time_input_div {\n            width: 100%;\n            height: 35px;\n            line-height: 35px;\n            font-size: 14px;\n            padding: 0 10px;\n            box-sizing: border-box;\n            border: 1px solid #aebab4;\n            border-radius: 1px;\n          }\n          input {\n            width: 100%;\n            font-size: 14px;\n            padding: 0 10px;\n            box-sizing: border-box;\n            border: 1px solid #aebab4;\n            border-radius: 1px;\n            outline: none;\n          }\n          select {\n            width: 100%;\n            height: 35px;\n            font-size: 14px;\n            padding: 0 10px;\n            box-sizing: border-box;\n            border: 1px solid #aebab4;\n            border-radius: 1px;\n            outline: none;\n            appearance: none;\n            -moz-appearance: none;\n            -webkit-appearance: none;\n            -ms-appearance: none;\n            background: #ffffff;\n          }\n          .time_input {\n            width: 100%;\n            height: 35px;\n            position: relative;\n            .dateTime {\n              position: absolute;\n              top: 0px;\n              right: 10px;\n              color: #aebab4;\n            }\n            input {\n              width: 100%;\n              font-size: 14px;\n              padding: 0 20px 0 10px;\n              box-sizing: border-box;\n              border: 1px solid #aebab4;\n              border-radius: 1px;\n              outline: none;\n            }\n          }\n          .time_text {\n            width: 80px;\n            height: 35px;\n            text-align: center;\n            line-height: 35px;\n            font-size: 14px;\n            color: #333333;\n          }\n        }\n      }\n      .pop-box-txt {\n        line-height: 17px;\n      }\n    }\n  }\n  .tab5_box {\n    width: 100%;\n    .tab5-search {\n      width: 100%;\n      height: 34px;\n      display: flex;\n      border-radius: 1px;\n      margin-bottom: 10px;\n      height: 34px;\n      border-top: 1px solid #aebab4;\n      border-bottom: 1px solid #aebab4;\n      border-left: 1px solid #aebab4;\n      box-sizing: border-box;\n      .search-left {\n        flex: 1;\n        height: 32px;\n        line-height: 32px;\n        display: flex;\n        background: #ffffff;\n        .search-left-left {\n          width: 32px;\n          height: 32px;\n        }\n        .search-left-center {\n          flex: 1;\n          height: 32px;\n          input {\n            width: 100%;\n            height: 30px;\n            padding: 0 10px;\n            font-size: 12px;\n            color: #333333;\n          }\n        }\n        .search-left-right {\n          width: 50px;\n          height: 32px;\n          font-size: 12px;\n          color: #333333;\n          position: relative;\n          select {\n            width: 100%;\n            height: 32px;\n            position: absolute;\n            top: 0;\n            left: 0;\n            opacity: 0;\n          }\n        }\n      }\n      .search-right {\n        height: 32px;\n      }\n    }\n    .tab5-count {\n      width: 100%;\n      height: 35px;\n      line-height: 35px;\n      color: #999999;\n      font-size: 12px;\n    }\n    .tab5-list {\n      width: 100%;\n      background: #ffffff;\n      box-shadow: 0 2px 4px 0 rgba(0, 0, 0, 0.1);\n      border-radius: 5px;\n      padding: 10px 20px;\n      box-sizing: border-box;\n      margin-bottom: 15px;\n      position: relative;\n      .icon1 {\n        position: absolute;\n        bottom: 30px;\n        right: 35px;\n      }\n      .icon2 {\n        position: absolute;\n        bottom: 30px;\n        right: 10px;\n      }\n      .tab5-list-tilte {\n        width: 100%;\n        height: 35px;\n        line-height: 35px;\n        margin-bottom: 15px;\n        .span1 {\n          font-size: 16px;\n          color: #333333;\n          font-weight: bold;\n          float: left;\n          line-height: 30px;\n          height: 30px;\n          overflow: hidden;\n        }\n        .span2 {\n          font-size: 12px;\n          float: right;\n          font-weight: bold;\n        }\n      }\n      .tab5-list-p {\n        width: 100%;\n        height: 30px;\n        line-height: 30px;\n        font-size: 12px;\n        color: #333333;\n        .span-left {\n          width: 100%;\n          display: block;\n          float: left;\n          white-space: nowrap;\n          overflow: hidden;\n          text-overflow: ellipsis;\n        }\n        .span-right {\n          float: right;\n          color: #999999;\n        }\n      }\n      .tab5-list-p1 {\n        font-size: 14px;\n        color: #999999;\n      }\n    }\n  }\n\n  .tab-footer {\n    width: 100%;\n    height: 70px;\n    background: #fcfcfc;\n    position: fixed;\n    bottom: 0;\n    left: 0;\n    padding: 0 10px;\n    box-sizing: border-box;\n  }\n}\n</style>\n"],"sourceRoot":"src/views/AfterLoanManagement"}]}